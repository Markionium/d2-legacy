"use strict";!function(e,d){d.utils={scriptPath:function(){var d;return function(){var t,r,s=e.element('<script src=""></script>');return d?d:(t=document.getElementsByTagName("script"),e.forEach(t,function(e){/d2(\.min)?\.js$/i.test(e.src)&&(s=e)}),r=s.src||"",d=r.substring(0,r.lastIndexOf("/")+1))}}()},e.module("d2-services",["d2-rest"]),e.module("d2-filters",[]),e.module("d2-datatable",["d2-filters"]),e.module("d2-breadcrumbs",[]),e.module("d2-introlist",[]),e.module("d2-headerbar",[]),e.module("d2-directives",["d2-breadcrumbs","d2-introlist","d2-headerbar","d2-datatable"]),e.module("d2",["d2-services","d2-directives","d2-filters"])}(angular,window.d2=window.d2||{});
"use strict";!function(r){r.module("d2-breadcrumbs").directive("d2BreadCrumbs",function(){return{restrict:"E",replace:!0,scope:!0,templateUrl:d2.utils.scriptPath()+"common/breadcrumbs/breadcrumbs.html",controller:["$scope","d2BreadCrumbsService",function(c,e){c.crumbsList=e.getCrumbsList(),c.crumbClick=function(t){e.resetCrumbs(t.id),c.crumbsList=e.getCrumbsList(),t.click&&t.click(r.copy(t))}}]}})}(angular);
"use strict";!function(t,i){t.module("d2-breadcrumbs").service("d2BreadCrumbsService",function(){this.crumbsList=[],this.addCrumb=function(i,s){var r={};r.name=i,r.id=this.crumbsList.length,s&&t.isFunction(s)&&(r.click=function(){return s()}),this.crumbsList.push(r)},this.resetCrumbs=function(t){t===i&&(t=0),this.crumbsList=_.filter(this.crumbsList,function(i){return i.id<=t})},this.getCrumbsList=function(){return this.crumbsList}})}(angular);
"use strict";!function(t,e){var a=t.module("d2-datatable");a.controller("DataTableController",["$scope","$q",function(a,n){var o=this;this.localSort=!0,this.getHeadersFromData=function(){var t=[];return _.map(a.items,function(e){var a=e.getDataOnly?e.getDataOnly():e;return _.map(a,function(e,a){t.push({name:a})}),t}),t=_.uniq(t,function(t){return t.name}),a.columns=t,a.columns},this.parseTableConfig=function(){var t=a.tableConfig||{};a.pageItems=t.pageItems,a.columns=t.columns||e},this.parseTableData=function(){t.isArray(a.tableData)&&a.tableData.getList!==e&&(this.localSort=!1,a.d2Service=a.tableData,a.tableData=a.d2Service.getList()),n.when(a.tableData).then(this.processData.bind(this))},this.processData=function(t){a.items=t,a.columns=a.columns||this.getHeadersFromData(),a.pageItems&&(a.items=a.items.slice(0,a.pageItems))},this.setSortOrder=function(n){var o=t.copy(a.columns);t.forEach(o,function(t){t.sort=t.name===n.name?"asc"===n.sort?"desc":"asc":e}),a.columns=o,a.$digest()},this.setSearchOnColumn=function(){},this.doLocalSorting=function(){var t,e=_.filter(a.columns,"sort"),n=_.pluck(e,"name");0!==e.length&&(t=_.sortBy(a.items,n),e[0]&&"desc"===e[0].sort&&(t=t.reverse()),a.items=t)},this.serviceSorting=function(){{var t=_.filter(a.columns,"sort");_.pluck(t,"name")}0!==t.length&&alert("API Sorting not yet implemented")},a.$watch("columns",function(t,e){e!==t&&a.items.length>0&&(o.localSort&&o.doLocalSorting(),a.d2Service&&o.serviceSorting())},!0)}]),a.directive("d2DataTable",function(){return{restrict:"E",replace:!0,scope:{tableConfig:"=",tableData:"="},templateUrl:d2.utils.scriptPath()+"common/datatable/datatable.html",controller:"DataTableController",link:function(t,e,a,n){n.parseTableConfig(),n.parseTableData()}}})}(angular);
"use strict";!function(e){var n=e.module("d2-datatable");n.directive("d2DataTableHeader",function(){return{restrict:"AC",replace:!0,require:"^d2DataTable",transclude:!0,scope:{column:"="},template:'<th class="table-header"><a ng-click="sortOrder()" href="#" ng-if="column.sortable" ng-transclude ng-class="\'sorting-\' + column.sort"></a><span ng-if="!column.sortable" ng-transclude></span><input ng-change="doSearch()" ng-if="column.searchable" ng-model="column.filter" type="search"></th>',link:function(e,n,r,a){e.sortOrder=function(){a.setSortOrder(e.column)},e.doSearch=function(){console.log(e.column),a.setSearchOnColumn(e.column)}}}})}(angular);
"use strict";!function(t){t.module("d2-datatable").provider("d2DataTableCreator",function(){return{$get:function(){return function(){return{}}}}})}(angular);

"use strict";!function(t){t.module("d2-filters").filter("capitalize",function(){return function(i){return t.isString(i)?i.charAt(0).toUpperCase()+i.slice(1):i}})}(angular);
"use strict";!function(e){var t=e.module("d2-headerbar");t.directive("d2HeaderBar",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{title:"@",link:"@",logo:"@",hasContent:"@"},templateUrl:d2.utils.scriptPath()+"common/headerbar/headerbar.html",compile:function(e,t){t.title=t.title||"District Health Information Software 2",t.link=t.link||"../dhis-web-dashboard-integration/index.action",t.logo=t.logo||"../dhis-web-commons/css/light_blue/logo_banner.png"}}})}(angular);
"use strict";!function(t){t.module("d2-introlist").directive("d2IntroList",function(){return{restrict:"E",replace:!0,scope:{itemList:"=",itemClick:"&"},templateUrl:d2.utils.scriptPath()+"common/introlist/introlist.html",link:function(i){i.clickFunction=function(n){var c={item:t.copy(n)};i.itemClick(c)}}}})}(angular);
"use strict";!function(e){e.module("d2-services").service("currentUser",["d2Api",function(n){var s,t,i=this;this.userLoaded=!1,this.permissionsLoaded=!1,this.getPermissions=function(){return s},this.hasPermission=function(e){return t.indexOf(e)>0?!0:!1},n.currentUser.get().then(function(n){e.extend(i,n.getDataOnly())}),s=n.currentUser.permissions.getList().then(function(e){return i.permissionsLoaded=!0,t=e.getDataOnly()})}])}(angular);
"use strict";!function(t){var n=t.module("d2-rest",["restangular"]);n.provider("d2Api",["RestangularProvider",function(n){var e=function(){this.indicators=this.all("indicators"),this.currentUser=this.one("me"),this.currentUser.permissions=this.one("me").all("authorization"),this.schemas=this.all("schemas"),this.addEndPoint=function(t,n){this[t]=n?this.one("endPointName"):this.all("endPointName")}};this.setBaseUrl=function(t){this.config.setBaseUrl(t)},this.$get=["Restangular",function(t){var n;return n=e,n.prototype=t,new e}],this.config=n,this.config.addResponseInterceptor(function(n,e,i){if("getList"===e&&n&&n[i]){var r=n[i],s=t.copy(n);return delete s[i],r.meta=s,r}return n}),this.config.setResponseExtractor(function(n){var e=n,i=t.copy(n);return e.getDataOnly=function(){return i},e}),this.config.setOnElemRestangularized(function(n,e,i,r){return e||n.getDataOnly?n:(n.getDataOnly=function(){var e=t.copy(n);return e=r.stripRestangular(e),delete e.getDataOnly,e},n)})}]),n.config(["d2ApiProvider",function(t){t.setBaseUrl("/dhis/api")}])}(angular);
"use strict";!function(s,t){s.module("d2-services").factory("schemaProcessor",function(){return function(r){var i=new function(){this.schemas=[],this.schemaGroups={},this.getKlassGroupName=function(s){var t=s.split(".");return t[t.length-2]},this.addSchemasToGroups=function(r){var i=this,e={};return s.forEach(r,function(s){var r=i.getKlassGroupName(s.klass);e[r]===t&&(e[r]=[]),e[r].push(s)}),this.schemaGroups=e,e},this.filterSchemasByPermissions=function(t){var r=[];return s.forEach(this.schemas,function(s){s.isAuthorizedBy(t)&&r.push(s)}),r},this.process=function(t){this.schemas=t,s.forEach(this.schemas,function(t){t.getPermissions=function(){var t={all:[]};return s.forEach(this.authorities,function(s){"DELETE"===s.type?t.remove=s.authorities:t[s.type.toLowerCase()]=s.authorities,t.all=t.all.concat(s.authorities)}),t},t.isAuthorizedBy=function(r){var i=!1,e=t.getPermissions();return s.forEach(e.all,function(s){r.indexOf(s)>=0&&(t.permissions=e,i=!0)}),i}})},this.getSchemaGroupsForPermissions=function(s){var t=this.filterSchemasByPermissions(s),r=this.addSchemasToGroups(t);return r},this.filterByGroupNames=function(t){var r=this.addSchemasToGroups(this.schemas),i={};return s.forEach(t,function(s){r[s]&&(i[s]=r[s])}),i}};return i.process(r||[]),i}})}(angular);